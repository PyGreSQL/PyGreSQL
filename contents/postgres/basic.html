<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Basic examples &#8212; PyGreSQL 6.2.3</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=27fed22d" />
    <script src="../../_static/documentation_options.js?v=c6c79ff1"></script>
    <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="next" title="Examples for advanced features" href="advanced.html" />
    <link rel="prev" title="A PostgreSQL Primer" href="index.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="basic-examples">
<h1>Basic examples<a class="headerlink" href="#basic-examples" title="Link to this heading">¶</a></h1>
<p>In this section, we demonstrate how to use some of the very basic features
of PostgreSQL using the classic PyGreSQL interface.</p>
<section id="creating-a-connection-to-the-database">
<h2>Creating a connection to the database<a class="headerlink" href="#creating-a-connection-to-the-database" title="Link to this heading">¶</a></h2>
<p>We start by creating a <strong>connection</strong> to the PostgreSQL database:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pg</span><span class="w"> </span><span class="kn">import</span> <span class="n">DB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span> <span class="o">=</span> <span class="n">DB</span><span class="p">()</span>
</pre></div>
</div>
<p>If you pass no parameters when creating the <a class="reference internal" href="../pg/db_wrapper.html#pg.DB" title="pg.DB"><code class="xref py py-class docutils literal notranslate"><span class="pre">DB</span></code></a> instance, then
PyGreSQL will try to connect to the database on the local host that has
the same name as the current user, and also use that name for login.</p>
<p>You can also pass the database name, host, port and login information
as parameters when creating the <a class="reference internal" href="../pg/db_wrapper.html#pg.DB" title="pg.DB"><code class="xref py py-class docutils literal notranslate"><span class="pre">DB</span></code></a> instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span> <span class="o">=</span> <span class="n">DB</span><span class="p">(</span><span class="n">dbname</span><span class="o">=</span><span class="s1">&#39;testdb&#39;</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s1">&#39;pgserver&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5432</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">user</span><span class="o">=</span><span class="s1">&#39;scott&#39;</span><span class="p">,</span> <span class="n">passwd</span><span class="o">=</span><span class="s1">&#39;tiger&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../pg/db_wrapper.html#pg.DB" title="pg.DB"><code class="xref py py-class docutils literal notranslate"><span class="pre">DB</span></code></a> class of which <code class="docutils literal notranslate"><span class="pre">db</span></code> is an object is a wrapper around
the lower level <a class="reference internal" href="../pg/connection.html#pg.Connection" title="pg.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> class of the <a class="reference internal" href="../pg/index.html#module-pg" title="pg"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pg</span></code></a> module.
The most important method of such connection objects is the <code class="docutils literal notranslate"><span class="pre">query</span></code>
method that allows you to send SQL commands to the database.</p>
</section>
<section id="creating-tables">
<h2>Creating tables<a class="headerlink" href="#creating-tables" title="Link to this heading">¶</a></h2>
<p>The first thing you would want to do in an empty database is creating a
table. To do this, you need to send a <strong>CREATE TABLE</strong> command to the
database. PostgreSQL has its own set of built-in types that can be used
for the table columns. Let us create two tables “weather” and “cities”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;CREATE TABLE weather (</span>
<span class="gp">... </span><span class="s2">    city varchar(80),</span>
<span class="gp">... </span><span class="s2">    temp_lo int, temp_hi int,</span>
<span class="gp">... </span><span class="s2">    prcp float8,</span>
<span class="gp">... </span><span class="s2">    date date)&quot;&quot;&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;CREATE TABLE cities (</span>
<span class="gp">... </span><span class="s2">    name varchar(80),</span>
<span class="gp">... </span><span class="s2">    location point)&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Keywords are case-insensitive but identifiers are case-sensitive.</p>
</div>
<p>You can get a list of all tables in the database with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">get_tables</span><span class="p">()</span>
<span class="go">[&#39;public.cities&#39;, &#39;public.weather&#39;]</span>
</pre></div>
</div>
</section>
<section id="insert-data">
<h2>Insert data<a class="headerlink" href="#insert-data" title="Link to this heading">¶</a></h2>
<p>Now we want to fill our tables with data. An <strong>INSERT</strong> statement is used
to insert a new row into a table. There are several ways you can specify
what columns the data should go to.</p>
<p>Let us insert a row into each of these tables. The simplest case is when
the list of values corresponds to the order of the columns specified in the
CREATE TABLE command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;INSERT INTO weather</span>
<span class="gp">... </span><span class="s2">    VALUES (&#39;San Francisco&#39;, 46, 50, 0.25, &#39;11/27/1994&#39;)&quot;&quot;&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;INSERT INTO cities</span>
<span class="gp">... </span><span class="s2">    VALUES (&#39;San Francisco&#39;, &#39;(-194.0, 53.0)&#39;)&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also specify the columns to which the values correspond. The columns can
be specified in any order. You may also omit any number of columns,
such as with unknown precipitation, below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;INSERT INTO weather (date, city, temp_hi, temp_lo)</span>
<span class="gp">... </span><span class="s2">    VALUES (&#39;11/29/1994&#39;, &#39;Hayward&#39;, 54, 37)&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If you get errors regarding the format of the date values, your database
is probably set to a different date style. In this case you must change
the date style like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;set datestyle = MDY&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Instead of explicitly writing the INSERT statement and sending it to the
database with the <a class="reference internal" href="../pg/db_wrapper.html#pg.DB.query" title="pg.DB.query"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DB.query()</span></code></a> method, you can also use the more
convenient <a class="reference internal" href="../pg/db_wrapper.html#pg.DB.insert" title="pg.DB.insert"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DB.insert()</span></code></a> method that does the same under the hood:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;weather&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">date</span><span class="o">=</span><span class="s1">&#39;11/29/1994&#39;</span><span class="p">,</span> <span class="n">city</span><span class="o">=</span><span class="s1">&#39;Hayward&#39;</span><span class="p">,</span> <span class="n">temp_hi</span><span class="o">=</span><span class="mi">54</span><span class="p">,</span> <span class="n">temp_lo</span><span class="o">=</span><span class="mi">37</span><span class="p">)</span>
</pre></div>
</div>
<p>And instead of using keyword parameters, you can also pass the values
to the <a class="reference internal" href="../pg/db_wrapper.html#pg.DB.insert" title="pg.DB.insert"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DB.insert()</span></code></a> method in a single Python dictionary.</p>
<p>If you have a Python list with many rows that shall be used to fill
a database table quickly, you can use the <code class="xref py py-meth docutils literal notranslate"><span class="pre">DB.inserttable()</span></code> method.</p>
</section>
<section id="retrieving-data">
<h2>Retrieving data<a class="headerlink" href="#retrieving-data" title="Link to this heading">¶</a></h2>
<p>After having entered some data into our tables, let’s see how we can get
the data out again. A <strong>SELECT</strong> statement is used for retrieving data.
The basic syntax is:</p>
<div class="highlight-psql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="k">columns</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">tables</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">predicates</span>
</pre></div>
</div>
<p>A simple one would be the following query:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM weather&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">    city     |temp_lo|temp_hi|prcp|   date</span>
<span class="go">-------------+-------+-------+----+----------</span>
<span class="go">San Francisco|     46|     50|0.25|1994-11-27</span>
<span class="go">Hayward      |     37|     54|    |1994-11-29</span>
<span class="go">(2 rows)</span>
</pre></div>
</div>
<p>You may also specify expressions in the target list.
(The ‘AS column’ specifies the column name of the result. It is optional.)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;SELECT city, (temp_hi+temp_lo)/2 AS temp_avg, date</span>
<span class="gp">... </span><span class="s2">    FROM weather&quot;&quot;&quot;</span><span class="p">))</span>
<span class="go">    city     |temp_avg|   date</span>
<span class="go">-------------+--------+----------</span>
<span class="go">San Francisco|      48|1994-11-27</span>
<span class="go">Hayward      |      45|1994-11-29</span>
<span class="go">(2 rows)</span>
</pre></div>
</div>
<p>If you want to retrieve rows that satisfy certain condition (i.e. a
restriction), specify the condition in a WHERE clause. The following
retrieves the weather of San Francisco on rainy days:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;SELECT * FROM weather</span>
<span class="gp">... </span><span class="s2">    WHERE city = &#39;San Francisco&#39; AND prcp &gt; 0.0&quot;&quot;&quot;</span><span class="p">))</span>
<span class="go">    city     |temp_lo|temp_hi|prcp|   date</span>
<span class="go">-------------+-------+-------+----+----------</span>
<span class="go">San Francisco|     46|     50|0.25|1994-11-27</span>
<span class="go">(1 row)</span>
</pre></div>
</div>
<p>Here is a more complicated one. Duplicates are removed when DISTINCT is
specified. ORDER BY specifies the column to sort on. (Just to make sure the
following won’t confuse you, DISTINCT and ORDER BY can be used separately.)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;SELECT DISTINCT city FROM weather ORDER BY city&quot;</span><span class="p">))</span>
<span class="go">    city</span>
<span class="go">-------------</span>
<span class="go">Hayward</span>
<span class="go">San Francisco</span>
<span class="go">(2 rows)</span>
</pre></div>
</div>
<p>So far we have only printed the output of a SELECT query. The object that is
returned by the query is an instance of the <a class="reference internal" href="../pg/query.html#pg.Query" title="pg.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> class that can print
itself in the nicely formatted way we saw above. But you can also retrieve the
results as a list of tuples, by using the <a class="reference internal" href="../pg/query.html#pg.Query.getresult" title="pg.Query.getresult"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.getresult()</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pprint</span><span class="w"> </span><span class="kn">import</span> <span class="n">pprint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM weather&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">getresult</span><span class="p">())</span>
<span class="go">[(&#39;San Francisco&#39;, 46, 50, 0.25, &#39;1994-11-27&#39;),</span>
<span class="go"> (&#39;Hayward&#39;, 37, 54, None, &#39;1994-11-29&#39;)]</span>
</pre></div>
</div>
<p>Here we used pprint to print out the returned list in a nicely formatted way.</p>
<p>If you want to retrieve the results as a list of dictionaries instead of
tuples, use the <a class="reference internal" href="../pg/query.html#pg.Query.dictresult" title="pg.Query.dictresult"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.dictresult()</span></code></a> method instead:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">dictresult</span><span class="p">())</span>
<span class="go">[{&#39;city&#39;: &#39;San Francisco&#39;,</span>
<span class="go">  &#39;date&#39;: &#39;1994-11-27&#39;,</span>
<span class="go">  &#39;prcp&#39;: 0.25,</span>
<span class="go">  &#39;temp_hi&#39;: 50,</span>
<span class="go">  &#39;temp_lo&#39;: 46},</span>
<span class="go"> {&#39;city&#39;: &#39;Hayward&#39;,</span>
<span class="go">  &#39;date&#39;: &#39;1994-11-29&#39;,</span>
<span class="go">  &#39;prcp&#39;: None,</span>
<span class="go">  &#39;temp_hi&#39;: 54,</span>
<span class="go">  &#39;temp_lo&#39;: 37}]</span>
</pre></div>
</div>
<p>Finally, you can also retrieve the results as a list of named tuples, using
the <a class="reference internal" href="../pg/query.html#pg.Query.namedresult" title="pg.Query.namedresult"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.namedresult()</span></code></a> method. This can be a good compromise between
simple tuples and the more memory intensive dictionaries:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">q</span><span class="o">.</span><span class="n">namedresult</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">city</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">date</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">San Francisco 1994-11-27</span>
<span class="go">Hayward 1994-11-29</span>
</pre></div>
</div>
<p>If you only want to retrieve a single row of data, you can use the more
convenient <a class="reference internal" href="../pg/db_wrapper.html#pg.DB.get" title="pg.DB.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DB.get()</span></code></a> method that does the same under the hood:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">city</span><span class="o">=</span><span class="s1">&#39;Hayward&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;weather&#39;</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="s1">&#39;city&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">{&#39;city&#39;: &#39;Hayward&#39;,</span>
<span class="go"> &#39;date&#39;: &#39;1994-11-29&#39;,</span>
<span class="go"> &#39;prcp&#39;: None,</span>
<span class="go"> &#39;temp_hi&#39;: 54,</span>
<span class="go"> &#39;temp_lo&#39;: 37}</span>
</pre></div>
</div>
<p>As you see, the <a class="reference internal" href="../pg/db_wrapper.html#pg.DB.get" title="pg.DB.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DB.get()</span></code></a> method returns a dictionary with the column
names as keys. In the third parameter you can specify which column should
be looked up in the WHERE statement of the SELECT statement that is executed
by the <a class="reference internal" href="../pg/db_wrapper.html#pg.DB.get" title="pg.DB.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DB.get()</span></code></a> method. You normally don’t need it when the table was
created with a primary key.</p>
</section>
<section id="retrieving-data-into-other-tables">
<h2>Retrieving data into other tables<a class="headerlink" href="#retrieving-data-into-other-tables" title="Link to this heading">¶</a></h2>
<p>A SELECT … INTO statement can be used to retrieve data into another table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;SELECT * INTO TEMPORARY TABLE temptab FROM weather</span>
<span class="gp">... </span><span class="s2">    WHERE city = &#39;San Francisco&#39; and prcp &gt; 0.0&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This fills a temporary table “temptab” with a subset of the data in the
original “weather” table. It can be listed with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;SELECT * from temptab&quot;</span><span class="p">))</span>
<span class="go">    city     |temp_lo|temp_hi|prcp|   date</span>
<span class="go">-------------+-------+-------+----+----------</span>
<span class="go">San Francisco|     46|     50|0.25|1994-11-27</span>
<span class="go">(1 row)</span>
</pre></div>
</div>
</section>
<section id="aggregates">
<h2>Aggregates<a class="headerlink" href="#aggregates" title="Link to this heading">¶</a></h2>
<p>Let’s try the following query:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;SELECT max(temp_lo) FROM weather&quot;</span><span class="p">))</span>
<span class="go">max</span>
<span class="go">---</span>
<span class="go"> 46</span>
<span class="go">(1 row)</span>
</pre></div>
</div>
<p>You can also use aggregates with the GROUP BY clause:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;SELECT city, max(temp_lo) FROM weather GROUP BY city&quot;</span><span class="p">))</span>
<span class="go">    city     |max</span>
<span class="go">-------------+---</span>
<span class="go">Hayward      | 37</span>
<span class="go">San Francisco| 46</span>
<span class="go">(2 rows)</span>
</pre></div>
</div>
</section>
<section id="joining-tables">
<h2>Joining tables<a class="headerlink" href="#joining-tables" title="Link to this heading">¶</a></h2>
<p>Queries can access multiple tables at once or access the same table in such a
way that multiple instances of the table are being processed at the same time.</p>
<p>Suppose we want to find all the records that are in the temperature range of
other records. W1 and W2 are aliases for weather. We can use the following
query to achieve that:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;SELECT W1.city, W1.temp_lo, W1.temp_hi,</span>
<span class="gp">... </span><span class="s2">    W2.city, W2.temp_lo, W2.temp_hi FROM weather W1, weather W2</span>
<span class="gp">... </span><span class="s2">    WHERE W1.temp_lo &lt; W2.temp_lo and W1.temp_hi &gt; W2.temp_hi&quot;&quot;&quot;</span><span class="p">))</span>
<span class="go"> city  |temp_lo|temp_hi|    city     |temp_lo|temp_hi</span>
<span class="go">-------+-------+-------+-------------+-------+-------</span>
<span class="go">Hayward|     37|     54|San Francisco|     46|     50</span>
<span class="go">(1 row)</span>
</pre></div>
</div>
<p>Now let’s join two different tables. The following joins the “weather” table
and the “cities” table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;SELECT city, location, prcp, date</span>
<span class="gp">... </span><span class="s2">    FROM weather, cities</span>
<span class="gp">... </span><span class="s2">    WHERE name = city&quot;&quot;&quot;</span><span class="p">))</span>
<span class="go">    city     |location |prcp|   date</span>
<span class="go">-------------+---------+----+----------</span>
<span class="go">San Francisco|(-194,53)|0.25|1994-11-27</span>
<span class="go">(1 row)</span>
</pre></div>
</div>
<p>Since the column names are all different, we don’t have to specify the table
name. If you want to be clear, you can do the following. They give identical
results, of course:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;SELECT w.city, c.location, w.prcp, w.date</span>
<span class="gp">... </span><span class="s2">    FROM weather w, cities c WHERE c.name = w.city&quot;&quot;&quot;</span><span class="p">))</span>
<span class="go">    city     |location |prcp|   date</span>
<span class="go">-------------+---------+----+----------</span>
<span class="go">San Francisco|(-194,53)|0.25|1994-11-27</span>
<span class="go">(1 row)</span>
</pre></div>
</div>
</section>
<section id="updating-data">
<h2>Updating data<a class="headerlink" href="#updating-data" title="Link to this heading">¶</a></h2>
<p>It you want to change the data that has already been inserted into a database
table, you will need the <strong>UPDATE</strong> statement.</p>
<p>Suppose you discover the temperature readings are all off by 2 degrees as of
Nov 28, you may update the data as follow:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;UPDATE weather</span>
<span class="gp">... </span><span class="s2">    SET temp_hi = temp_hi - 2,  temp_lo = temp_lo - 2</span>
<span class="gp">... </span><span class="s2">    WHERE date &gt; &#39;11/28/1994&#39;&quot;&quot;&quot;</span><span class="p">)</span>
<span class="go">&#39;1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;SELECT * from weather&quot;</span><span class="p">))</span>
<span class="go">    city     |temp_lo|temp_hi|prcp|   date</span>
<span class="go">-------------+-------+-------+----+----------</span>
<span class="go">San Francisco|     46|     50|0.25|1994-11-27</span>
<span class="go">Hayward      |     35|     52|    |1994-11-29</span>
<span class="go">(2 rows)</span>
</pre></div>
</div>
<p>Note that the UPDATE statement returned the string <code class="docutils literal notranslate"><span class="pre">'1'</span></code>, indicating that
exactly one row of data has been affected by the update.</p>
<p>If you retrieved one row of data as a dictionary using the <a class="reference internal" href="../pg/db_wrapper.html#pg.DB.get" title="pg.DB.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DB.get()</span></code></a>
method, then you can also update that row with the <a class="reference internal" href="../pg/db_wrapper.html#pg.DB.update" title="pg.DB.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DB.update()</span></code></a> method.</p>
</section>
<section id="deleting-data">
<h2>Deleting data<a class="headerlink" href="#deleting-data" title="Link to this heading">¶</a></h2>
<p>To delete rows from a table, a <strong>DELETE</strong> statement can be used.</p>
<p>Suppose you are no longer interested in the weather of Hayward, you can do
the following to delete those rows from the table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;DELETE FROM weather WHERE city = &#39;Hayward&#39;&quot;</span><span class="p">)</span>
<span class="go">&#39;1&#39;</span>
</pre></div>
</div>
<p>Again, you get the string <code class="docutils literal notranslate"><span class="pre">'1'</span></code> as return value, indicating that exactly
one row of data has been deleted.</p>
<p>You can also delete all the rows in a table by doing the following.
This is different from DROP TABLE which removes the table itself in addition
to the removing the rows, as explained in the next section.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;DELETE FROM weather&quot;</span><span class="p">)</span>
<span class="go">&#39;1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;SELECT * from weather&quot;</span><span class="p">))</span>
<span class="go">city|temp_lo|temp_hi|prcp|date</span>
<span class="go">----+-------+-------+----+----</span>
<span class="go">(0 rows)</span>
</pre></div>
</div>
<p>Since only one row was left in the table, the DELETE query again returns the
string <code class="docutils literal notranslate"><span class="pre">'1'</span></code>. The SELECT query now gives an empty result.</p>
<p>If you retrieved a row of data as a dictionary using the <a class="reference internal" href="../pg/db_wrapper.html#pg.DB.get" title="pg.DB.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DB.get()</span></code></a>
method, then you can also delete that row with the <a class="reference internal" href="../pg/db_wrapper.html#pg.DB.delete" title="pg.DB.delete"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DB.delete()</span></code></a> method.</p>
</section>
<section id="removing-the-tables">
<h2>Removing the tables<a class="headerlink" href="#removing-the-tables" title="Link to this heading">¶</a></h2>
<p>The <strong>DROP TABLE</strong> command is used to remove tables. After you have done this,
you can no longer use those tables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;DROP TABLE weather, cities&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;select * from weather&quot;</span><span class="p">)</span>
<span class="go">pg.ProgrammingError: Error:  Relation &quot;weather&quot; does not exist</span>
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/pygresql.png" alt="Logo of PyGreSQL"/>
            </a></p>
<h1 class="logo"><a href="../../index.html">PyGreSQL</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About PyGreSQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../copyright.html">Copyright notice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../download/index.html">Download information</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">The PyGreSQL documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#contents">Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../community/index.html">PyGreSQL Development and Support</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">The PyGreSQL documentation</a><ul>
  <li><a href="index.html">A PostgreSQL Primer</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">A PostgreSQL Primer</a></li>
      <li>Next: <a href="advanced.html" title="next chapter">Examples for advanced features</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2026, The PyGreSQL team.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 9.1.0</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../_sources/contents/postgres/basic.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>